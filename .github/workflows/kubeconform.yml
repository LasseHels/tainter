on:
  workflow_call:

jobs:
  kubeconform:
    name: Kubeconform
    permissions:
      contents: read
    runs-on: ubuntu-22.04
    steps:
      # Deliberately set up Kubeconform before checking out the repository, as we might otherwise get name collisions
      # between the kubeconform directory and kubeconform binary (which have the same name).
      - name: Setup Kubeconform
        run: |
          curl -L -O https://github.com/yannh/kubeconform/releases/download/v0.6.7/kubeconform-linux-amd64.tar.gz
          tar -xvf kubeconform-linux-amd64.tar.gz
          mv kubeconform /usr/local/bin
      - name: Checkout
        uses: actions/checkout@v4
      - name: Run Kubeconform
        run: make kubeconform
